import"./vuedraggable.umd-B0pI6CdV.js";import{a as w}from"./energyApi-BelWF7_m.js";import{_ as W,r as t,I as X,J as C,K as Y,c as N,e as r,b as n,w as o,F as L,d as u,o as g,x as Z,t as x,i as U,y as I,s as ee}from"./index-CjguSdL3.js";const ae={class:"container"},te={class:"select-area"},le={class:"content-area"},ne={class:"scrollable-list"},oe={__name:"index",setup(se){t(null);const _=t([]),m=t([]);t([]),t(105);const d=t("");t(""),t("");const f=t(!1);X(async()=>{await F()});const B=async()=>{d.value&&(c.value=1,await b(),C.success("成功加载 ".concat(R.value," 的数据")))},F=async()=>{let e=await w.nox_company();e.code==200?_.value=e.data:C.error("nox_company:"+e.msg)},R=Y(()=>{const e=_.value.find(a=>a.dictValue===d.value);return e?e.dictLabel:""});t([]);const T=e=>{switch(e){case"1":return"success";case"2":return"primary";case"失败":return"danger";case"等待中":return"warning";default:return"info"}};t([{text:"已清洗",value:"1"},{text:"未清洗",value:"2"},{text:"进行中",value:"processing"}]);const b=async()=>{let e=await w.aodatepage({company:d.value,pageNum:c.value,pageSize:p.value});e.code==200?e.rows&&e.rows.length>0&&(S.value=e.total,z.value=e.rows.map((a,h)=>({...a,statusShow:a.status=="1"?"已清洗":"等待中"}))):C.error("aodatelist:"+e.msg)},z=t([]),c=t(1),p=t(15);t(!1),t(!1),t(!0);const S=t(0),E=e=>{p.value=e,b()},M=e=>{c.value=e,b()};t([]);const $=async e=>{const a=e.target.files[0];a&&console.log("handleFileUpload……",a)},J=t(null),i=t(1),v=t(15),V=t(0),P=t({}),K=async e=>{f.value=!0,i.value=1,P.value=e,await y()},j=e=>{v.value=e,y()},q=e=>{i.value=e,y()},y=async()=>{m.value=[];let e=await w.filterRecordpage({aoDateId:P.value.id,pageNum:i.value,pageSize:v.value});e.code==200&&e.rows&&(V.value=e.total,e.rows&&e.rows.length>0&&(m.value=e.rows.map((a,h)=>({...a}))))};return(e,a)=>{const h=u("el-option"),A=u("el-select"),s=u("el-table-column"),G=u("el-tag"),H=u("el-button"),k=u("el-table"),D=u("el-pagination"),O=u("el-card"),Q=u("el-dialog");return g(),N(L,null,[r("div",ae,[r("div",te,[a[4]||(a[4]=r("span",{class:"promptspan"},"工厂名称：",-1)),n(A,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=l=>d.value=l),placeholder:"请选择工厂名称",onChange:B,clearable:"",filterable:""},{default:o(()=>[(g(!0),N(L,null,Z(_.value,l=>(g(),I(h,{key:l.dictCode,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),r("input",{type:"file",ref_key:"fileInput",ref:J,onChange:$,accept:".csv,.txt",style:{display:"none"}},null,544)]),r("div",le,[n(O,{class:"original-list"},{header:o(()=>a[5]||(a[5]=[r("h2",null,"数据清洗情况",-1)])),default:o(()=>[r("div",ne,[n(k,{data:z.value,style:{width:"100%"},border:""},{default:o(()=>[n(s,{prop:"index",label:"序号",width:"60"},{default:o(({$index:l})=>[r("span",null,x(l+1+(c.value-1)*p.value)+".",1)]),_:1}),n(s,{prop:"date",label:"文件名称"}),n(s,{prop:"status",label:"状态"},{default:o(({row:l})=>[n(G,{type:T(l.status)},{default:o(()=>[U(x(l.statusShow),1)]),_:2},1032,["type"])]),_:1}),n(s,{prop:"createTime",label:"清洗时间"}),n(s,{label:"操作",width:"160"},{default:o(({row:l})=>[l.filterRecordStatus==1?(g(),I(H,{key:0,type:"primary",size:"small",onClick:re=>K(l)},{default:o(()=>a[6]||(a[6]=[U(" 清洗记录 ")])),_:2},1032,["onClick"])):ee("",!0)]),_:1})]),_:1},8,["data"]),n(D,{currentPage:c.value,"onUpdate:currentPage":a[1]||(a[1]=l=>c.value=l),"page-size":p.value,total:S.value,layout:"total,prev, pager, next",onSizeChange:E,onCurrentChange:M},null,8,["currentPage","page-size","total"])])]),_:1})])]),n(Q,{modelValue:f.value,"onUpdate:modelValue":a[3]||(a[3]=l=>f.value=l),title:"清洗记录",width:"70%"},{default:o(()=>[n(k,{data:m.value,style:{width:"100%"},"highlight-current-row":""},{default:o(()=>[n(s,{prop:"index",label:"序号",width:"60"},{default:o(({$index:l})=>[r("span",null,x(l+1+(i.value-1)*v.value)+".",1)]),_:1}),n(s,{prop:"colName",label:"列名",width:"180"}),n(s,{prop:"symbol",label:"判断条件"}),n(s,{prop:"value",label:"值"}),n(s,{prop:"number",label:"过滤数据条数"})]),_:1},8,["data"]),n(D,{currentPage:i.value,"onUpdate:currentPage":a[2]||(a[2]=l=>i.value=l),"page-size":v.value,total:V.value,layout:"total,prev, pager, next",onSizeChange:j,onCurrentChange:q},null,8,["currentPage","page-size","total"])]),_:1},8,["modelValue"])],64)}}},de=W(oe,[["__scopeId","data-v-3d78bad8"]]);export{de as default};
