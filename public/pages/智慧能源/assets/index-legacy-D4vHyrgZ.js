System.register(["./energyApi-legacy-6I-V7-GA.js","./index-legacy-Cgp3PKn6.js"],(function(e,a){"use strict";var l,t,u,r,d,i,o,n,s,p,v,c,m,g,h,f,y,_;return{setters:[e=>{l=e.a,t=e.G},e=>{u=e._,r=e.r,d=e.K,i=e.I,o=e.c,n=e.e,s=e.b,p=e.w,v=e.C,c=e.d,m=e.o,g=e.i,h=e.t,f=e.y,y=e.N,_=e.J}],execute:function(){var a=document.createElement("style");a.textContent=".filter-area[data-v-18812d46]{margin-bottom:20px;display:flex;gap:10px}.select-area[data-v-18812d46]{display:flex;align-items:center;gap:10px;padding-top:10px}.select-area .promptspan[data-v-18812d46]{width:100px}.select-area .promptsel[data-v-18812d46]{width:150px}.content-area[data-v-18812d46]{display:flex;gap:20px;margin-top:20px}.original-list[data-v-18812d46]{width:100%}.algorithm-management[data-v-18812d46]{padding:20px;max-width:1000px;margin:0 auto}.section-header[data-v-18812d46]{display:flex;justify-content:space-between;align-items:center;margin:20px 0 15px}.form-actions[data-v-18812d46]{margin-top:30px;text-align:right}.el-upload__tip[data-v-18812d46]{font-size:12px;color:#909399;margin-top:7px}[data-v-18812d46] .el-upload-list{width:250px}\n",document.head.appendChild(a);const w={class:"container"},x={class:"select-area"},b={class:"content-area"},V={class:"scrollable-list"},k={class:"algorithm-management"},F={class:"el-upload__tip"},C={class:"el-upload__tip"},P={class:"form-actions"},z={__name:"index",setup(e){r(""),r([]);const a=r(!1),u=r(!1),z=r(null),U=r(1),q=r(15),D=r(0),S=r([]),W=r("");d((()=>{const e=S.value.find((e=>e.dictValue===W.value));return e?e.dictLabel:""})),i((async()=>{await B()}));const j=r([]),B=async()=>{let e=await l.algpage({company:W.value,pageNum:U.value,pageSize:q.value});200==e.code&&e.rows&&e.rows.length>0&&(D.value=e.total,j.value=e.rows.map(((e,a)=>({...e}))))};function I(){u.value=!1,z.value=null,L.value={name:"",path:"",remark:""},se.value="",pe.value="",a.value=!0}r([]),r([]),i((()=>{}));const L=r({name:"",path:"",remark:""}),A={name:[{required:!0,message:"请输入算法名称",trigger:"blur"}],algorithmFile:[{required:!0,message:"请上传训练算法文件",trigger:"change"}],algorithmFile2:[{required:!0,message:"请上传预测算法文件",trigger:"change"}]},N=r([]),R=r([]),T=e=>{if(!e.raw.name.endsWith(".py"))return _.error("只能上传.py文件"),!1;L.value.algorithmFile=e.raw,Y.value.validateField("algorithmFile",(e=>{}))},E=()=>{N.value=[],L.value.algorithmFile=null,console.log(L.value),Y.value.validateField("algorithmFile")},G=e=>{if(!e.raw.name.endsWith(".py"))return _.error("只能上传.py文件"),!1;L.value.algorithmFile2=e.raw,Y.value.validateField("algorithmFile2",(e=>{}))},J=()=>{L.value.algorithmFile2=null,Y.value.validateField("algorithmFile2")},K=r([]),O=r(!1),$=r(!1),H=r(null),M=r({id:"",name:"",no:"",value:""}),Q=r(null),X=()=>{if(M.id&&M.name&&M.value){if($.value){const e=K.value.findIndex((e=>e.id===H.value));-1!==e&&(K.value[e]={...M})}else{if(K.value.some((e=>e.id===M.id)))return void _.warning("该参数标识已存在");K.value.push({...M})}O.value=!1}else _.warning("请填写完整的参数信息")},Y=r(null),Z=async()=>{try{await Y.value.validate(),u.value?200==(await l.algupdate(L.value)).code&&(_.success("修改成功"),B()):200==(await l.algadd(L.value)).code&&(_.success("新增成功"),B()),a.value=!1}catch(e){_.error("请填写完整信息",e)}},ee=()=>{a.value=!1},ae=e=>{q.value=e,B()},le=e=>{U.value=e,B()};let te=t();const ue=r(te+"/alg/upload"),re=r({Authorization:"Bearer your_token_here"}),de=r({type:"train"}),ie=r({type:"predict"}),oe=r(Date.now()),ne=r(Date.now()),se=r(""),pe=r(""),ve=(e,a,l)=>{200===e.code?(_.success("上传成功"),l.value=[{name:e.data,url:e.data,status:"success",percentage:100}],console.log("fileList:",l.value),se.value=e.data,L.value.trainPath=e.data):_.error(e.message||"上传失败")},ce=(e,a,l)=>{200===e.code?(_.success("上传成功"),l.value=[{name:e.data,url:e.data,status:"success",percentage:100}],console.log("fileList:",l.value),pe.value=e.data,L.value.predictPath=e.data):_.error(e.message||"上传失败")},me=(e,a,l)=>{console.error("上传失败:",e),_.error("文件上传失败1")},ge=()=>{N.value=[],R.value=[],oe.value=Date.now(),ne.value=Date.now()},he=e=>(ge(),!!e.name.endsWith(".py")||(_.error("只能上传.py文件"),!1)),fe=e=>(ge(),!!e.name.endsWith(".py")||(_.error("只能上传.py文件"),!1)),ye=async()=>{await v(),Y.value?.clearValidate()};return(e,t)=>{const r=c("el-button"),d=c("el-table-column"),i=c("el-table"),v=c("el-pagination"),S=c("el-card"),W=c("el-input"),K=c("el-form-item"),H=c("el-upload"),te=c("el-form"),ge=c("el-dialog");return m(),o("div",w,[n("div",x,[s(r,{type:"primary",onClick:I},{default:p((()=>t[9]||(t[9]=[g("新增算法")]))),_:1})]),n("div",b,[s(S,{class:"original-list"},{header:p((()=>t[10]||(t[10]=[n("h2",null,"算法配置",-1)]))),default:p((()=>[n("div",V,[s(i,{data:j.value,style:{width:"100%"},border:""},{default:p((()=>[s(d,{prop:"index",label:"序号",width:"60"},{default:p((({$index:e})=>[n("span",null,h(e+1+(U.value-1)*q.value)+".",1)])),_:1}),s(d,{prop:"name",label:"算法名称"}),s(d,{prop:"remark",label:"备注"}),s(d,{label:"操作",width:"150"},{default:p((e=>[s(r,{size:"small",onClick:t=>(async e=>{u.value=!0,z.value=e.id,se.value="",pe.value="";let t=await l.algSingle({id:e.id});200==t.code&&(L.value={...t.data},t.data.trainPath&&(se.value=t.data.trainPath,L.value.algorithmFile=t.data.trainPath),t.data.predictPath&&(pe.value=t.data.predictPath,L.value.algorithmFile2=t.data.predictPath),a.value=!0)})(e.row)},{default:p((()=>t[11]||(t[11]=[g("修改")]))),_:2},1032,["onClick"]),s(r,{size:"small",type:"danger",onClick:a=>(async e=>{y.confirm("确定要删除这条数据吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{l.algdel({id:e.id}).then((e=>{200==e.code?(_.success("删除成功"),B()):_.error("删除失败")}))})).catch((()=>{_.info("已取消删除")}))})(e.row)},{default:p((()=>t[12]||(t[12]=[g("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),s(v,{currentPage:U.value,"onUpdate:currentPage":t[0]||(t[0]=e=>U.value=e),"page-size":q.value,total:D.value,layout:"total,prev, pager, next",onSizeChange:ae,onCurrentChange:le},null,8,["currentPage","page-size","total"])])])),_:1})]),s(ge,{modelValue:a.value,"onUpdate:modelValue":t[8]||(t[8]=e=>a.value=e),title:u.value?"编辑算法":"新增算法",width:"60%",height:"80%",onOpen:ye},{default:p((()=>[n("div",k,[s(te,{"label-width":"100px",model:L.value,rules:A,ref_key:"formRef",ref:Y},{default:p((()=>[s(K,{label:"算法名称：",prop:"name"},{default:p((()=>[s(W,{modelValue:L.value.name,"onUpdate:modelValue":t[1]||(t[1]=e=>L.value.name=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),s(K,{label:"训练文件：",prop:"algorithmFile"},{default:p((()=>[(m(),f(H,{class:"upload-demo",action:ue.value,headers:re.value,data:de.value,"before-upload":he,"on-success":ve,"on-error":me,"on-change":T,"on-remove":E,limit:1,"file-list":N.value,accept:".py","auto-upload":!0,key:oe.value},{trigger:p((()=>[s(r,{type:"primary"},{default:p((()=>t[13]||(t[13]=[g("上传文件(训练)")]))),_:1})])),tip:p((()=>[n("div",F," 服务器训练文件:"+h(se.value),1)])),_:1},8,["action","headers","data","file-list"]))])),_:1}),s(K,{label:"预测文件：",prop:"algorithmFile2"},{default:p((()=>[(m(),f(H,{class:"upload-demo",action:ue.value,headers:re.value,data:ie.value,"before-upload":fe,"on-success":ce,"on-error":me,"on-change":G,"on-remove":J,limit:1,"file-list":R.value,accept:".py","auto-upload":!0,key:ne.value},{trigger:p((()=>[s(r,{type:"primary"},{default:p((()=>t[14]||(t[14]=[g("上传文件(预测)")]))),_:1})])),tip:p((()=>[n("div",C," 服务器预测文件:"+h(pe.value),1)])),_:1},8,["action","headers","data","file-list"]))])),_:1}),s(K,{label:"算法备注：",prop:"remark"},{default:p((()=>[s(W,{modelValue:L.value.remark,"onUpdate:modelValue":t[2]||(t[2]=e=>L.value.remark=e),type:"textarea",rows:3,placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),n("div",P,[s(r,{onClick:ee},{default:p((()=>t[15]||(t[15]=[g("取消")]))),_:1}),s(r,{type:"primary",onClick:Z},{default:p((()=>t[16]||(t[16]=[g("确定")]))),_:1})]),s(ge,{modelValue:O.value,"onUpdate:modelValue":t[7]||(t[7]=e=>O.value=e),title:$.value?"修改参数":"添加算法参数"},{footer:p((()=>[s(r,{onClick:t[6]||(t[6]=e=>O.value=!1)},{default:p((()=>t[17]||(t[17]=[g("取消")]))),_:1}),s(r,{type:"primary",onClick:X},{default:p((()=>t[18]||(t[18]=[g("确定")]))),_:1})])),default:p((()=>[s(te,{model:M.value,"label-width":"100px",ref_key:"paramFormRef",ref:Q},{default:p((()=>[s(K,{label:"参数标识：",prop:"id",required:""},{default:p((()=>[s(W,{modelValue:M.value.id,"onUpdate:modelValue":t[3]||(t[3]=e=>M.value.id=e),placeholder:"请输入",disabled:$.value},null,8,["modelValue","disabled"])])),_:1}),s(K,{label:"参数名称：",prop:"name",required:""},{default:p((()=>[s(W,{modelValue:M.value.name,"onUpdate:modelValue":t[4]||(t[4]=e=>M.value.name=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),s(K,{label:"参数值：",prop:"value",required:""},{default:p((()=>[s(W,{modelValue:M.value.value,"onUpdate:modelValue":t[5]||(t[5]=e=>M.value.value=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])])),_:1},8,["modelValue","title"])])}}};e("default",u(z,[["__scopeId","data-v-18812d46"]]))}}}));
