System.register(["./energyApi-legacy-6I-V7-GA.js","./index-legacy-Cgp3PKn6.js"],(function(e,a){"use strict";var l,t,u,o,d,r,n,i,c,s,p,m,v,g,f,b,y,h,_;return{setters:[e=>{l=e.a,t=e.G},e=>{u=e._,o=e.r,d=e.K,r=e.I,n=e.J,i=e.c,c=e.e,s=e.b,p=e.w,m=e.d,v=e.o,g=e.F,f=e.x,b=e.i,y=e.t,h=e.y,_=e.N}],execute:function(){var a=document.createElement("style");a.textContent=".filter-area[data-v-0eb1796b]{margin-bottom:20px;display:flex;gap:10px}.select-area[data-v-0eb1796b]{display:flex;align-items:center;gap:10px;padding-top:10px}.select-area .promptspan[data-v-0eb1796b]{width:100px}.select-area .promptsel[data-v-0eb1796b]{width:150px}.content-area[data-v-0eb1796b]{display:flex;gap:20px;margin-top:20px}.original-list[data-v-0eb1796b]{width:100%}\n",document.head.appendChild(a);const w={class:"container"},V={class:"select-area"},x={class:"content-area"},z={class:"el-upload__tip"},C={class:"dialog-footer"};e("default",u({__name:"index",setup(e){o("");const a=o([]),u=o(!1),k=o(!1),F=o(null),S=o([]),j=o(""),U=d((()=>{const e=S.value.find((e=>e.dictValue===j.value));return e?e.dictLabel:""}));r((async()=>{await L()}));const q=async()=>{j.value&&(await B(),n.success(`成功加载 ${U.value} 的数据`))},L=async()=>{let e=await l.nox_company();200==e.code?(S.value=e.data,D.value=e.data):n.error("nox_company:"+e.msg)},B=async()=>{let e=await l.ruleSpeclist({company:j.value});200==e.code?(a.value=[],e.data&&e.data.length>0&&(a.value=e.data.map(((e,a)=>({...e}))))):n.error("加载特殊规则报错:"+e.msg)},A=o({id:"",company:"",ruleKey:"",description:""}),D=o([]);function I(){j.value?(k.value=!1,F.value=null,A.value={company:j.value,col_name:"",symbol:"",value:""},N.value="",u.value=!0):n.warning("请先选择工厂名称")}o([]),r((()=>{}));const K=async e=>{},T=async()=>{await W.value.validate(),k.value?200==(await l.ruleSpecupdate(A.value)).code&&(n.success("修改成功"),B()):200==(await l.ruleSpecadd(A.value)).code&&(n.success("新增成功"),B()),u.value=!1},W=o(null);let $=t();const E=o($+"/ruleSpec/upload"),G=o([]),J=o(Date.now()),N=o(""),R=o({Authorization:"Bearer your_token_here"}),H=o({type:"ruleSpec"}),M={name:[{required:!0,message:"请输入算法名称",trigger:"blur"}],method:[{required:!0,message:"请输入方法名",trigger:"blur"}],clazz:[{required:!0,message:"请输入类名",trigger:"blur"}],algorithmFile:[{required:!0,message:"请上传特殊规则文件",trigger:"change"}]},O=e=>(P(),!!e.name.endsWith(".jar")||(n.error("只能上传.jar文件"),!1)),P=()=>{G.value=[],J.value=Date.now()},Q=(e,a,l)=>{200===e.code?(n.success("上传成功"),l.value=[{name:e.data,url:e.data,status:"success",percentage:100}],console.log("fileList:",l.value),N.value=e.data,A.value.url=e.data):n.error(e.message||"上传失败")},X=(e,a,l)=>{console.error("上传失败:",e),n.error("文件上传失败")},Y=e=>{if(!e.raw.name.endsWith(".jar"))return n.error("只能上传.jar文件"),!1;A.value.algorithmFile=e.raw,W.value.validateField("algorithmFile",(e=>{}))},Z=()=>{G.value=[],A.value.algorithmFile=null,console.log(A.value),W.value.validateField("algorithmFile")};return(e,t)=>{const o=m("el-option"),d=m("el-select"),r=m("el-button"),U=m("el-table-column"),L=m("el-table"),$=m("el-card"),P=m("el-form-item"),ee=m("el-input"),ae=m("el-upload"),le=m("el-form"),te=m("el-dialog");return v(),i("div",w,[c("div",V,[t[9]||(t[9]=c("span",{class:"promptspan"},"工厂名称：",-1)),s(d,{class:"promptsel",modelValue:j.value,"onUpdate:modelValue":t[0]||(t[0]=e=>j.value=e),placeholder:"请选择工厂名称",onChange:q,clearable:"",filterable:""},{default:p((()=>[(v(!0),i(g,null,f(S.value,(e=>(v(),h(o,{key:e.dictCode,label:e.dictLabel,value:e.dictValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),s(r,{type:"primary",onClick:I},{default:p((()=>t[8]||(t[8]=[b("新增特殊规则")]))),_:1})]),c("div",x,[s($,{class:"original-list"},{default:p((()=>[s(L,{data:a.value,border:"",style:{width:"100%"}},{default:p((()=>[s(U,{prop:"index",label:"序号",width:"60"},{default:p((({$index:e})=>[c("span",null,y(e+1)+".",1)])),_:1}),s(U,{prop:"name",label:"名称"},{default:p((e=>[c("span",null,y(e.row.name),1)])),_:1}),s(U,{prop:"clazz",label:"类名"},{default:p((e=>[c("span",null,y(e.row.clazz),1)])),_:1}),s(U,{prop:"method",label:"方法名"},{default:p((e=>[c("span",null,y(e.row.method),1)])),_:1}),s(U,{prop:"description",label:"描述"},{default:p((e=>[c("span",null,y(e.row.description),1)])),_:1}),s(U,{label:"操作",width:"150"},{default:p((e=>[s(r,{size:"small",onClick:a=>(async e=>{k.value=!0,F.value=e.id;let a=await l.ruleSpecSingle({id:e.id});200==a.code&&(A.value={...a.data},a.data.url&&(N.value=a.data.url,A.value.algorithmFile=a.data.url),u.value=!0)})(e.row)},{default:p((()=>t[10]||(t[10]=[b("修改")]))),_:2},1032,["onClick"]),s(r,{size:"small",type:"danger",onClick:a=>(async e=>{_.confirm("确定要删除这条数据吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{l.ruleSpecdel({id:e.id}).then((e=>{200==e.code?(n.success("删除成功"),B()):n.error("删除失败")}))})).catch((()=>{n.info("已取消删除")}))})(e.row)},{default:p((()=>t[11]||(t[11]=[b("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1})]),s(te,{modelValue:u.value,"onUpdate:modelValue":t[7]||(t[7]=e=>u.value=e),title:k.value?"编辑特殊规则":"新增特殊规则",width:"50%"},{footer:p((()=>[c("span",C,[s(r,{onClick:t[6]||(t[6]=e=>u.value=!1)},{default:p((()=>t[13]||(t[13]=[b("取消")]))),_:1}),s(r,{type:"primary",onClick:T},{default:p((()=>t[14]||(t[14]=[b("确定")]))),_:1})])])),default:p((()=>[s(le,{model:A.value,"label-width":"120px",rules:M,ref_key:"formRef",ref:W},{default:p((()=>[s(P,{label:"工厂"},{default:p((()=>[s(d,{modelValue:A.value.company,"onUpdate:modelValue":t[1]||(t[1]=e=>A.value.company=e),placeholder:"请选择工厂",onChange:K,disabled:!0},{default:p((()=>[(v(!0),i(g,null,f(D.value,(e=>(v(),h(o,{key:e.dictCode,label:e.dictLabel,value:e.dictValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(P,{label:"名称",prop:"name"},{default:p((()=>[s(ee,{modelValue:A.value.name,"onUpdate:modelValue":t[2]||(t[2]=e=>A.value.name=e)},null,8,["modelValue"])])),_:1}),s(P,{label:"类名",prop:"clazz"},{default:p((()=>[s(ee,{modelValue:A.value.clazz,"onUpdate:modelValue":t[3]||(t[3]=e=>A.value.clazz=e)},null,8,["modelValue"])])),_:1}),s(P,{label:"方法",prop:"method"},{default:p((()=>[s(ee,{modelValue:A.value.method,"onUpdate:modelValue":t[4]||(t[4]=e=>A.value.method=e)},null,8,["modelValue"])])),_:1}),s(P,{label:"规则文件：",prop:"algorithmFile"},{default:p((()=>[(v(),h(ae,{class:"upload-demo",action:E.value,headers:R.value,data:H.value,"before-upload":O,"on-success":Q,"on-error":X,"on-change":Y,"on-remove":Z,limit:1,"file-list":G.value,accept:".jar","auto-upload":!0,key:J.value},{trigger:p((()=>[s(r,{type:"primary"},{default:p((()=>t[12]||(t[12]=[b("上传文件")]))),_:1})])),tip:p((()=>[c("div",z," 服务器训练文件:"+y(N.value),1)])),_:1},8,["action","headers","data","file-list"]))])),_:1}),s(P,{label:"描述"},{default:p((()=>[s(ee,{modelValue:A.value.description,"onUpdate:modelValue":t[5]||(t[5]=e=>A.value.description=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-0eb1796b"]]))}}}));
