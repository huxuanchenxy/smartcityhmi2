import{a as b,G as oe}from"./energyApi-BelWF7_m.js";import{_ as se,r as t,K as G,I as j,J as d,V as re,c as J,e as s,b as n,w as r,i as L,F as K,L as N,d as c,o as y,x as ue,t as T,y as W,s as ie}from"./index-CjguSdL3.js";import"./index-CuDBRX2J.js";const de={class:"container"},ce={class:"select-area"},pe={class:"top-section"},ve={class:"content-area"},me={class:"scrollable-list"},ge={__name:"index",setup(we){t(""),t(null);const h=t([]),C=t([]);t(null),t(null);const p=t("");t(""),t("");const u=t(""),i=t("");t(""),t(""),t(1e3),t(80),t(""),t(!1),t(""),t(!1),t(""),t(105),t(""),t("图片加载失败"),G(()=>{var e,a,o;return((e=z.value.datetimes)==null?void 0:e.length)>0&&((a=z.value.actuals)==null?void 0:a.length)>0&&((o=z.value.predicts)==null?void 0:o.length)>0}),j(async()=>{await A()});const q=async()=>{p.value&&(m.value=1,S.value=0,u.value="",i.value="",await O(),await w(),d.success("成功加载 ".concat(H.value," 的数据")))},A=async()=>{let e=await b.nox_company();e.code==200?h.value=e.data:d.error("nox_company:"+e.msg)},H=G(()=>{const e=h.value.find(a=>a.dictValue===p.value);return e?e.dictLabel:""});t([]);const w=async()=>{try{V.value=[];let e=u.value?N(u.value).format("YYYY-MM-DD"):"",a=i.value?N(i.value).format("YYYY-MM-DD"):"",o=await b.aodatepage({company:p.value,pageNum:m.value,pageSize:f.value,startDate:e,endDate:a});o.code==200?o.rows&&o.rows.length>0&&(S.value=o.total,V.value=o.rows.map((P,Y)=>({...P}))):d.error("trainpage:"+o.msg)}catch(e){d.error("trainpage:"+e.message)}finally{}},O=async()=>{let e=await b.aodatelist({company:p.value});e.code==200?(D.value=[],e.data&&e.data.length>0&&e.data.forEach(a=>{D.value.push(a.date)})):d.error("加载可用时间段出错:"+e.msg)},V=t([]),D=t([]);function M(e){const a=N(e).format("YYYY-MM-DD");return!D.value.includes(a)}t(!1);const x=t(!1);t(null),t(!1);const z=t({datetimes:["2023-12-09 00:00:00","2023-12-09 00:00:01","2023-12-09 00:00:02","2023-12-09 00:00:03"],actuals:["136.29754638671875","136.30165100097656","136.303955078125","136.3086700439453"],predicts:["136.29754638671875","136.30165100097656","136.303955078125","136.3086700439453"]}),U=t({}),Q=async e=>{x.value=!0,g.value=1,U.value=e,await k()},k=async()=>{C.value=[];let e=await b.aoWarnpage({aoDateId:U.value.id,pageNum:g.value,pageSize:_.value});e.code==200&&e.rows&&(R.value=e.total,e.rows&&e.rows.length>0&&(C.value=e.rows.map((a,o)=>({...a}))))};j(()=>{window.addEventListener("resize",E)}),re(()=>{window.removeEventListener("resize",E)});const E=()=>{},m=t(1),f=t(15),S=t(0),g=t(1),_=t(15),R=t(0);t("");const X=e=>{f.value=e,w()},Z=e=>{m.value=e,w()},ee=e=>{_.value=e,k()},ae=e=>{g.value=e,k()},te=async()=>{if(!p.value){d.warning("请先选择工厂名称");return}if(u.value>i.value){d.warning("结束时间要大于等于开始时间");return}try{await w()}catch(e){console.log("取消保存",e)}};oe();const B=async()=>{if(!p.value){d.warning("请先选择工厂"),u.value="",i.value="";return}if(u.value&&i.value&&u.value>i.value){d.warning("开始时间不能大于结束时间"),u.value="",i.value="";return}};return(e,a)=>{const o=c("el-option"),P=c("el-select"),Y=c("el-date-picker"),F=c("el-button"),v=c("el-table-column"),I=c("el-table"),$=c("el-pagination"),le=c("el-card"),ne=c("el-dialog");return y(),J(K,null,[s("div",de,[s("div",ce,[s("div",pe,[a[8]||(a[8]=s("span",{class:"promptspan"},"工厂名称：",-1)),n(P,{modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=l=>p.value=l),placeholder:"请选择工厂名称",onChange:q,clearable:"",filterable:""},{default:r(()=>[(y(!0),J(K,null,ue(h.value,l=>(y(),W(o,{key:l.dictCode,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a[9]||(a[9]=s("span",{class:"promptspan"},"筛选时间范围：",-1)),n(Y,{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=l=>u.value=l),type:"date",placeholder:"开始时间",onFocus:B,style:{width:"100%","max-width":"180px"},"disabled-date":M,align:"right"},null,8,["modelValue"]),a[10]||(a[10]=L(" 至 ")),n(Y,{modelValue:i.value,"onUpdate:modelValue":a[2]||(a[2]=l=>i.value=l),type:"date","disabled-date":M,placeholder:"结束时间",onFocus:B,style:{width:"100%","max-width":"180px"},align:"right"},null,8,["modelValue"]),n(F,{type:"primary",onClick:a[3]||(a[3]=l=>te()),title:"请选择1.工厂名称 2. 筛选时间范围"},{default:r(()=>a[7]||(a[7]=[L(" 查询 ")])),_:1})]),a[11]||(a[11]=s("div",{class:"time-range-section"},null,-1))]),s("div",ve,[n(le,{class:"original-list"},{header:r(()=>a[12]||(a[12]=[s("h2",null,"数据训练情况",-1)])),default:r(()=>[s("div",me,[n(I,{data:V.value,style:{width:"100%"},border:""},{default:r(()=>[n(v,{prop:"index",label:"序号",width:"60"},{default:r(({$index:l})=>[s("span",null,T(l+1+(m.value-1)*f.value)+".",1)]),_:1}),n(v,{prop:"date",label:"训练时间"}),n(v,{prop:"cnt",label:"训练行数"}),n(v,{label:"操作",width:"160"},{default:r(({row:l})=>[l.warnStatus==1?(y(),W(F,{key:0,type:"primary",size:"small",onClick:fe=>Q(l)},{default:r(()=>a[13]||(a[13]=[L(" 报警历史 ")])),_:2},1032,["onClick"])):ie("",!0)]),_:1})]),_:1},8,["data"]),n($,{currentPage:m.value,"onUpdate:currentPage":a[4]||(a[4]=l=>m.value=l),"page-size":f.value,total:S.value,layout:"total,prev, pager, next",onSizeChange:X,onCurrentChange:Z},null,8,["currentPage","page-size","total"])])]),_:1})])]),n(ne,{modelValue:x.value,"onUpdate:modelValue":a[6]||(a[6]=l=>x.value=l),title:"报警历史",width:"70%"},{default:r(()=>[n(I,{data:C.value,style:{width:"100%"},onRowClick:e.handleRowClick,"row-class-name":e.tableRowClassName,"highlight-current-row":""},{default:r(()=>[n(v,{prop:"index",label:"序号",width:"60"},{default:r(({$index:l})=>[s("span",null,T(l+1+(g.value-1)*_.value)+".",1)]),_:1}),n(v,{prop:"warnStart",label:"报警时间",width:"180"}),n(v,{prop:"colName",label:"出现重复的列"}),n(v,{prop:"lineNum",label:"重复行数"})]),_:1},8,["data","onRowClick","row-class-name"]),n($,{currentPage:g.value,"onUpdate:currentPage":a[5]||(a[5]=l=>g.value=l),"page-size":_.value,total:R.value,layout:"total,prev, pager, next",onSizeChange:ee,onCurrentChange:ae},null,8,["currentPage","page-size","total"])]),_:1},8,["modelValue"])],64)}}},he=se(ge,[["__scopeId","data-v-a49bab64"]]);export{he as default};
