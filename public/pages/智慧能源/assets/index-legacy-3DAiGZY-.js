System.register(["./energyApi-legacy-6I-V7-GA.js","./index-legacy-Cgp3PKn6.js"],(function(e,a){"use strict";var l,t,u,d,o,n,c,i,s,r,p,v,m,f,y,b,_,g;return{setters:[e=>{l=e.a},e=>{t=e._,u=e.r,d=e.K,o=e.I,n=e.J,c=e.c,i=e.e,s=e.b,r=e.w,p=e.d,v=e.o,m=e.F,f=e.x,y=e.i,b=e.t,_=e.N,g=e.y}],execute:function(){var a=document.createElement("style");a.textContent=".filter-area[data-v-fa426949]{margin-bottom:20px;display:flex;gap:10px}.select-area[data-v-fa426949]{display:flex;align-items:center;gap:10px;padding-top:10px}.select-area .promptspan[data-v-fa426949]{width:100px}.select-area .promptsel[data-v-fa426949]{width:150px}.content-area[data-v-fa426949]{display:flex;gap:20px;margin-top:20px}.original-list[data-v-fa426949]{width:100%}\n",document.head.appendChild(a);const w={class:"container"},x={class:"select-area"},V={class:"content-area"},h={class:"dialog-footer"};e("default",t({__name:"index",setup(e){u("");const a=u([]),t=u(!1),C=u(!1),k=u(null),I=u([]),U=u(""),N=d((()=>{const e=I.value.find((e=>e.dictValue===U.value));return e?e.dictLabel:""}));o((async()=>{await j()}));const L=async()=>{U.value&&(await z(),await $(U.value),n.success(`成功加载 ${N.value} 的数据`))},j=async()=>{let e=await l.nox_company();200==e.code?(I.value=e.data,S.value=e.data):n.error("nox_company:"+e.msg)},z=async()=>{let e=await l.rulelist({company:U.value});200==e.code?(a.value=[],e.data&&e.data.length>0&&(a.value=e.data.map(((e,a)=>({...e}))))):n.error("加载规则报错:"+e.msg)},B=u({company:"",colName:"",symbol:"",value:"",colId:""}),S=u([]),T=u([]);o((()=>{}));const $=async e=>{let a=await l.csvmap({company:e});200==a.code?T.value=a.data:n.error("csvmap:"+a.msg)};function A(){U.value?(C.value=!1,k.value=null,B.value={company:U.value,colName:"",symbol:"",value:"",colId:""},t.value=!0):n.warning("请先选择工厂名称")}const E=async e=>{await $(e)},F=async()=>{C.value?200==(await l.ruleupdate(B.value)).code&&(n.success("修改成功"),z()):200==(await l.ruleadd(B.value)).code&&(n.success("新增成功"),z()),t.value=!1};return(e,u)=>{const d=p("el-option"),o=p("el-select"),N=p("el-button"),j=p("el-table-column"),J=p("el-table"),K=p("el-card"),q=p("el-form-item"),D=p("el-input"),G=p("el-form"),H=p("el-dialog");return v(),c("div",w,[i("div",x,[u[8]||(u[8]=i("span",{class:"promptspan"},"工厂名称：",-1)),s(o,{class:"promptsel",modelValue:U.value,"onUpdate:modelValue":u[0]||(u[0]=e=>U.value=e),placeholder:"请选择工厂名称",onChange:L,clearable:"",filterable:""},{default:r((()=>[(v(!0),c(m,null,f(I.value,(e=>(v(),g(d,{key:e.dictCode,label:e.dictLabel,value:e.dictValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),s(N,{type:"primary",onClick:A},{default:r((()=>u[7]||(u[7]=[y("新增规则")]))),_:1})]),i("div",V,[s(K,{class:"original-list"},{default:r((()=>[s(J,{data:a.value,border:"",style:{width:"100%"}},{default:r((()=>[s(j,{prop:"index",label:"序号",width:"60"},{default:r((({$index:e})=>[i("span",null,b(e+1),1)])),_:1}),s(j,{prop:"col_name",label:"列名"},{default:r((e=>[i("span",null,b(e.row.colName),1)])),_:1}),s(j,{prop:"symbol",label:"判断条件"}),s(j,{prop:"value",label:"值"}),s(j,{label:"操作",width:"150"},{default:r((e=>[s(N,{size:"small",onClick:a=>(async e=>{C.value=!0,k.value=e.id,await $(e.company);let a=await l.ruleSingle({id:e.id});200==a.code&&(B.value={...a.data},t.value=!0)})(e.row)},{default:r((()=>u[9]||(u[9]=[y("修改")]))),_:2},1032,["onClick"]),s(N,{size:"small",type:"danger",onClick:a=>(async e=>{_.confirm("确定要删除这条数据吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{l.ruledel({id:e.id}).then((e=>{200==e.code?(n.success("删除成功"),z()):n.error("删除失败")}))})).catch((()=>{n.info("已取消删除")}))})(e.row)},{default:r((()=>u[10]||(u[10]=[y("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1})]),s(H,{modelValue:t.value,"onUpdate:modelValue":u[6]||(u[6]=e=>t.value=e),title:C.value?"编辑规则":"新增规则",width:"50%"},{footer:r((()=>[i("span",h,[s(N,{onClick:u[5]||(u[5]=e=>t.value=!1)},{default:r((()=>u[11]||(u[11]=[y("取消")]))),_:1}),s(N,{type:"primary",onClick:F},{default:r((()=>u[12]||(u[12]=[y("确定")]))),_:1})])])),default:r((()=>[s(G,{model:B.value,"label-width":"120px"},{default:r((()=>[s(q,{label:"工厂"},{default:r((()=>[s(o,{modelValue:B.value.company,"onUpdate:modelValue":u[1]||(u[1]=e=>B.value.company=e),placeholder:"请选择工厂",onChange:E,disabled:!0},{default:r((()=>[(v(!0),c(m,null,f(S.value,(e=>(v(),g(d,{key:e.dictCode,label:e.dictLabel,value:e.dictValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(q,{label:"列名"},{default:r((()=>[s(o,{modelValue:B.value.colId,"onUpdate:modelValue":u[2]||(u[2]=e=>B.value.colId=e),placeholder:"请选择列名"},{default:r((()=>[(v(!0),c(m,null,f(T.value,(e=>(v(),g(d,{key:e.id,label:e.colName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(q,{label:"判断条件"},{default:r((()=>[s(D,{modelValue:B.value.symbol,"onUpdate:modelValue":u[3]||(u[3]=e=>B.value.symbol=e)},null,8,["modelValue"])])),_:1}),s(q,{label:"值"},{default:r((()=>[s(D,{modelValue:B.value.value,"onUpdate:modelValue":u[4]||(u[4]=e=>B.value.value=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-fa426949"]]))}}}));
